[gd_scene load_steps=52 format=3 uid="uid://bmicu2av4r0qn"]

[ext_resource type="Script" path="res://core/player.gd" id="1_dpv4o"]
[ext_resource type="Script" path="res://core/player_animtree.gd" id="2_4cmwe"]
[ext_resource type="PackedScene" uid="uid://nprju05ce2c5" path="res://art/model/human_model_0.1.glb" id="2_dbf1p"]
[ext_resource type="AnimationNodeBlendSpace1D" uid="uid://dc8k2o85s4da1" path="res://art/model/animations/animtree_nodes/human_movement_blend1d.tres" id="3_csu45"]
[ext_resource type="AnimationNodeStateMachine" uid="uid://dnomb2r2caopu" path="res://art/model/animations/animtree_nodes/human_stationary_statemachine.tres" id="4_s82sa"]
[ext_resource type="Animation" uid="uid://ce1hi8beucour" path="res://art/model/animations/human_0.1/aim_fire_small.res" id="5_2640a"]
[ext_resource type="PackedScene" uid="uid://deo4i0mfxnb4f" path="res://core/entities/player/collision_shapes/human_shape.tscn" id="5_fobq8"]
[ext_resource type="Animation" uid="uid://bx60lmiqnqgvb" path="res://art/model/animations/human_0.1/aim_idle.res" id="6_ngmar"]
[ext_resource type="PackedScene" uid="uid://d22yujbpyofme" path="res://core/entities/player/collision_shapes/wolf_shape.tscn" id="6_o2077"]
[ext_resource type="Animation" uid="uid://cb1s5vdrhgxku" path="res://art/model/animations/human_0.1/aim_pose.res" id="7_j853k"]
[ext_resource type="Animation" uid="uid://ctwqpqoljb62q" path="res://art/model/animations/human_0.1/fall.res" id="8_mfjih"]
[ext_resource type="Animation" uid="uid://bg8c286vb3hiv" path="res://art/model/animations/human_0.1/idle.res" id="9_nvm6h"]
[ext_resource type="Animation" uid="uid://bijaa4wxtaqf1" path="res://art/model/animations/human_0.1/jump.res" id="10_f628w"]
[ext_resource type="Animation" uid="uid://d4dwpcek5ad28" path="res://art/model/animations/human_0.1/kick_ready.res" id="11_vs66s"]
[ext_resource type="Animation" uid="uid://bgh0befd768la" path="res://art/model/animations/human_0.1/rest.res" id="12_vu2sd"]
[ext_resource type="Animation" uid="uid://bsdwr1yfmf4sh" path="res://art/model/animations/human_0.1/run.res" id="13_xg4wm"]
[ext_resource type="Animation" uid="uid://clthtcuyn7au3" path="res://art/model/animations/human_0.1/staff_attack_1.res" id="14_mcidh"]
[ext_resource type="Animation" uid="uid://clcrol4kg7pdl" path="res://art/model/animations/human_0.1/staff_base.res" id="15_08nt0"]
[ext_resource type="Animation" uid="uid://doia86secgolg" path="res://art/model/animations/human_0.1/walk.res" id="16_57e82"]
[ext_resource type="Animation" uid="uid://cyixh6bsfimie" path="res://art/model/animations/human_0.1/attack_1.res" id="17_67jlv"]
[ext_resource type="Animation" uid="uid://cnbwob2qbgxuf" path="res://art/model/animations/human_0.1/attack_2.res" id="18_xlxjb"]
[ext_resource type="Animation" uid="uid://ca1iu4ma8pg84" path="res://art/model/animations/human_0.1/attack_3.res" id="19_17x3y"]
[ext_resource type="AnimationLibrary" uid="uid://dktquc8enrunx" path="res://art/model/animations/human_0.1/anim_libs/attacks_coded.res" id="20_38tol"]
[ext_resource type="PackedScene" uid="uid://dpokf241s066u" path="res://art/model/wolf_model_0.1.glb" id="23_4u3jf"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_vqemf"]
albedo_color = Color(1, 0, 1, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_byb3j"]
albedo_color = Color(0, 1, 1, 1)

[sub_resource type="Curve" id="Curve_hyoh0"]
_data = [Vector2(0, 0.0526315), 0.0, 0.0, 0, 0, Vector2(0.498339, 0.357895), 2.20412, 2.20412, 0, 0, Vector2(0.611296, 1), 0.0, 0.0, 0, 0, Vector2(1, 0.494737), 0.0, 0.0, 0, 0]
point_count = 4

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_v3m60"]
filter_enabled = true
filters = ["human_armature/Skeleton3D:Center", "human_armature/Skeleton3D:leg.l", "human_armature/Skeleton3D:leg.r", "human_armature/Skeleton3D:thigh.l", "human_armature/Skeleton3D:thigh.r"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_yjsvj"]
nodes/actions/node = ExtResource("4_s82sa")
nodes/actions/position = Vector2(-300, 80)
nodes/blend_movement/node = SubResource("AnimationNodeBlend2_v3m60")
nodes/blend_movement/position = Vector2(20, 160)
nodes/movement/node = ExtResource("3_csu45")
nodes/movement/position = Vector2(-300, 300)
nodes/output/position = Vector2(400, 160)
node_connections = [&"output", 0, &"blend_movement", &"blend_movement", 0, &"actions", &"blend_movement", 1, &"movement"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_64ma6"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vc3c5"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4j020"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_g5a7y"]
blend_point_0/node = SubResource("AnimationNodeAnimation_64ma6")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_vc3c5")
blend_point_1/pos = 0.2
blend_point_2/node = SubResource("AnimationNodeAnimation_4j020")
blend_point_2/pos = 0.6
min_space = 0.0

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_s5xfw"]
graph_offset = Vector2(-355, 61)
nodes/movement/node = SubResource("AnimationNodeBlendSpace1D_g5a7y")
nodes/movement/position = Vector2(-220, 160)
node_connections = [&"output", 0, &"movement"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_g87jm"]
albedo_color = Color(1, 0.184314, 1, 1)

[sub_resource type="CylinderMesh" id="CylinderMesh_axjon"]
material = SubResource("StandardMaterial3D_g87jm")
top_radius = 0.25
bottom_radius = 0.25
height = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_hhvsd"]
size = Vector3(1, 1, 0.748966)

[sub_resource type="BoxShape3D" id="BoxShape3D_apw7h"]
size = Vector3(1.54409, 1, 1.19948)

[sub_resource type="AnimationLibrary" id="AnimationLibrary_jxakw"]
_data = {
"aim_fire_small": ExtResource("5_2640a"),
"aim_idle": ExtResource("6_ngmar"),
"aim_pose": ExtResource("7_j853k"),
"attack_1": ExtResource("17_67jlv"),
"attack_2": ExtResource("18_xlxjb"),
"attack_3": ExtResource("19_17x3y"),
"fall": ExtResource("8_mfjih"),
"idle": ExtResource("9_nvm6h"),
"jump": ExtResource("10_f628w"),
"kick_ready": ExtResource("11_vs66s"),
"rest": ExtResource("12_vu2sd"),
"run": ExtResource("13_xg4wm"),
"staff_attack_1": ExtResource("14_mcidh"),
"staff_base": ExtResource("15_08nt0"),
"walk": ExtResource("16_57e82")
}

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_hmww8"]
vertex_color_use_as_albedo = true
albedo_color = Color(0.301961, 0.419608, 1, 1)

[sub_resource type="BoxMesh" id="BoxMesh_55uq3"]
material = SubResource("StandardMaterial3D_hmww8")
size = Vector3(0.2, 0.2, 0.2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_heehu"]
vertex_color_use_as_albedo = true
albedo_color = Color(0.101961, 0.584314, 0.34902, 1)

[sub_resource type="BoxMesh" id="BoxMesh_chb3p"]
material = SubResource("StandardMaterial3D_heehu")
size = Vector3(0.2, 0.2, 0.2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ylkh8"]
vertex_color_use_as_albedo = true
albedo_color = Color(0.898039, 0.0980392, 0.309804, 1)

[sub_resource type="BoxMesh" id="BoxMesh_aftjj"]
material = SubResource("StandardMaterial3D_ylkh8")
size = Vector3(0.2, 0.2, 0.2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_erjs0"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_ef6tq"]
size = Vector3(0.5, 0.5, 0.01)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_rcktv"]
albedo_color = Color(1, 0, 0, 1)
emission_enabled = true
emission = Color(1, 0, 0, 1)
emission_energy_multiplier = 2.24

[sub_resource type="BoxMesh" id="BoxMesh_s6cnm"]
size = Vector3(0.03, 0.03, 2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ao13a"]
albedo_color = Color(1, 0, 1, 1)

[sub_resource type="PrismMesh" id="PrismMesh_ma6o0"]
size = Vector3(0.62, 0.83, 0.295)

[node name="player" type="CharacterBody3D" groups=["Player"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.96485, 0)
script = ExtResource("1_dpv4o")
test_mat_a = SubResource("StandardMaterial3D_vqemf")
test_mat_b = SubResource("StandardMaterial3D_byb3j")
cam_distance_curve = SubResource("Curve_hyoh0")

[node name="human_animtree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeBlendTree_yjsvj")
anim_player = NodePath("../human_node/human_model/AnimationPlayer")
advance_expression_base_node = NodePath("..")
active = true
parameters/blend_movement/blend_amount = 0
parameters/movement/blend_position = 0
script = ExtResource("2_4cmwe")

[node name="wolf_animtree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeBlendTree_s5xfw")
anim_player = NodePath("../wolf_node/wolf_model/AnimationPlayer")
advance_expression_base_node = NodePath("..")
active = true
parameters/movement/blend_position = 0.00172861
script = ExtResource("2_4cmwe")

[node name="human_shape" parent="." instance=ExtResource("5_fobq8")]

[node name="wolf_shape" parent="." instance=ExtResource("6_o2077")]

[node name="swivel_ring" type="Node3D" parent="."]

[node name="edge_ray" type="RayCast3D" parent="swivel_ring"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.5)
target_position = Vector3(0, -1.25, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="swivel_ring/edge_ray"]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
mesh = SubResource("CylinderMesh_axjon")

[node name="hitbox_small" type="Area3D" parent="swivel_ring"]
collision_layer = 16
collision_mask = 12
input_ray_pickable = false

[node name="boxshape1" type="CollisionShape3D" parent="swivel_ring/hitbox_small"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.130005, -0.406396)
shape = SubResource("BoxShape3D_hhvsd")

[node name="hitbox_big" type="Area3D" parent="swivel_ring"]
collision_layer = 16
collision_mask = 12
input_ray_pickable = false

[node name="boxshape2" type="CollisionShape3D" parent="swivel_ring/hitbox_big"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.219787, -0.957368)
shape = SubResource("BoxShape3D_apw7h")

[node name="human_node" type="Node3D" parent="."]
visible = false

[node name="human_model" parent="human_node" instance=ExtResource("2_dbf1p")]

[node name="human_armature" parent="human_node/human_model" index="0"]
transform = Transform3D(-0.312618, 0, -2.73299e-08, 0, 0.312618, 0, 2.73299e-08, 0, -0.312618, 0, 0.143265, 0)

[node name="Skeleton3D" parent="human_node/human_model/human_armature" index="0"]
bones/0/position = Vector3(0, -0.136647, -0.10598)
bones/0/rotation = Quaternion(0.0914123, -0.00244562, -0.0016501, 0.995809)
bones/1/rotation = Quaternion(-0.00763651, 0.0308402, 0.79657, 0.603711)
bones/2/rotation = Quaternion(0.0834039, -0.0313383, 0.324214, 0.941779)
bones/3/rotation = Quaternion(0.317049, 0.0415371, 0.0138462, 0.947398)
bones/5/rotation = Quaternion(-0.0269451, -0.0138632, 0.00401736, 0.999533)
bones/6/rotation = Quaternion(-0.0150778, -3.56578e-05, -0.000320333, 0.999886)
bones/10/position = Vector3(-0.34512, -0.192523, -0.00858107)
bones/10/rotation = Quaternion(-0.216157, 0.238932, 0.944439, 0.0649762)
bones/11/rotation = Quaternion(-0.38085, 0.00103341, -0.0028334, 0.924632)
bones/12/rotation = Quaternion(-0.0599468, -0.00843683, -0.742144, 0.667501)
bones/13/rotation = Quaternion(-0.0848398, -0.0241657, -0.257329, 0.962289)
bones/14/rotation = Quaternion(0.395912, -0.0344117, -0.113618, 0.910582)
bones/17/position = Vector3(0.358753, -0.19082, -0.0116346)
bones/17/rotation = Quaternion(0.0999762, 0.3275, 0.935813, -0.0836845)
bones/18/rotation = Quaternion(-0.23857, -0.095505, -0.0107567, 0.966358)

[node name="ear_a" parent="human_node/human_model/human_armature/Skeleton3D" index="0"]
transform = Transform3D(0.999448, -0.00253311, -0.0331121, -0.000751078, 0.995107, -0.0987969, 0.0332004, 0.0987673, 0.994557, 0.000675779, 1.70736, 0.173869)
bone_idx = 7

[node name="hair_a" parent="human_node/human_model/human_armature/Skeleton3D" index="1"]
transform = Transform3D(0.999448, -0.00253311, -0.0331121, -0.000751078, 0.995107, -0.0987969, 0.0332004, 0.0987673, 0.994557, 0.00858761, 2.12307, -0.0549009)
bone_idx = 8

[node name="cape" parent="human_node/human_model/human_armature/Skeleton3D" index="2"]
transform = Transform3D(0.999449, -0.0329398, 0.00416953, 0.0331203, 0.997917, -0.0553686, -0.00233701, 0.0554762, 0.998457, -0.0395435, 1.20386, -0.309412)
bone_idx = 9

[node name="staff_a" parent="human_node/human_model/human_armature/Skeleton3D" index="3"]
transform = Transform3D(0.381611, -0.302521, 0.873415, 0.862015, 0.457533, -0.218156, -0.33362, 0.836148, 0.435377, 1.40398, 0.0531692, 0.20743)
bone_idx = 16

[node name="standin_floor" parent="human_node/human_model" index="1"]
visible = false

[node name="AnimationPlayer" parent="human_node/human_model" index="2"]
reset_on_save = false
libraries = {
"": SubResource("AnimationLibrary_jxakw"),
"coded": ExtResource("20_38tol")
}

[node name="normal_gizmo" type="Node3D" parent="human_node/human_model"]

[node name="z" type="MeshInstance3D" parent="human_node/human_model/normal_gizmo"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.707599)
mesh = SubResource("BoxMesh_55uq3")
skeleton = NodePath("../../../..")

[node name="y" type="MeshInstance3D" parent="human_node/human_model/normal_gizmo"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.69777, 0.000264585)
mesh = SubResource("BoxMesh_chb3p")
skeleton = NodePath("../../../..")

[node name="x" type="MeshInstance3D" parent="human_node/human_model/normal_gizmo"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.708, 0, 0)
mesh = SubResource("BoxMesh_aftjj")
skeleton = NodePath("../../../..")

[node name="wolf_node" type="Node3D" parent="."]

[node name="wolf_model" parent="wolf_node" instance=ExtResource("23_4u3jf")]
transform = Transform3D(-0.115452, 0, -1.00931e-08, 0, 0.115452, 0, 1.00931e-08, 0, -0.115452, 0, 0.075846, 0)

[node name="Skeleton3D" parent="wolf_node/wolf_model/Armature" index="0"]
bones/1/rotation = Quaternion(0.657074, -8.93448e-16, -8.94236e-16, 0.753826)
bones/2/rotation = Quaternion(0.128876, 1.04071e-15, -9.13846e-17, 0.991661)
bones/3/rotation = Quaternion(-0.340625, 9.28477e-19, 7.59435e-17, 0.940199)
bones/4/rotation = Quaternion(-0.262286, 1.90548e-18, 6.4077e-17, 0.96499)
bones/5/rotation = Quaternion(0.455742, 4.27797e-20, -1.00897e-16, 0.890112)
bones/6/rotation = Quaternion(0.859775, 0.204093, 0.0176992, -0.467782)
bones/7/rotation = Quaternion(0.859775, -0.204093, -0.0176992, -0.467782)
bones/8/position = Vector3(0.903733, 0.952204, 1.19488)
bones/8/rotation = Quaternion(0.805228, 1.41192e-19, 3.90323e-18, 0.592965)
bones/9/rotation = Quaternion(0.102125, 1.18591e-07, 1.21295e-08, 0.994772)
bones/10/rotation = Quaternion(0.014444, -1.19197e-07, 1.72186e-09, 0.999896)
bones/11/rotation = Quaternion(-0.461468, 1.06032e-07, -5.44853e-08, 0.887157)
bones/12/position = Vector3(-0.903733, 0.951931, 1.19542)
bones/12/rotation = Quaternion(0.805915, 5.91052e-19, 4.16659e-18, 0.592031)
bones/13/rotation = Quaternion(0.103318, 1.18588e-07, 1.21505e-08, 0.994648)
bones/14/rotation = Quaternion(0.0117033, -1.19201e-07, 1.39515e-09, 0.999932)
bones/16/rotation = Quaternion(0.649025, -0.000736895, -0.0926, 0.75511)
bones/17/rotation = Quaternion(0.559808, -0.0218148, 0.0590463, 0.826228)
bones/18/rotation = Quaternion(-0.52007, 0.0295707, -0.0811033, 0.84975)
bones/19/rotation = Quaternion(0.864897, 0.000470506, 0.000165864, 0.50195)
bones/20/rotation = Quaternion(0.128068, 0.000327323, -0.000229017, 0.991765)
bones/21/rotation = Quaternion(0.332677, 0.000307772, -0.000573235, 0.94304)
bones/22/position = Vector3(-0.819108, 0.267881, 0.465688)
bones/22/rotation = Quaternion(0.647025, -0.0518984, 0.0104974, 0.760628)
bones/23/rotation = Quaternion(0.560398, 0.0218151, -0.058928, 0.825837)
bones/24/rotation = Quaternion(-0.519507, -0.029615, 0.0811072, 0.850092)

[node name="testfloor" parent="wolf_node/wolf_model" index="1"]
visible = false

[node name="cam_dial" type="Node3D" parent="."]

[node name="Player_Cam" type="Camera3D" parent="cam_dial" groups=["player_camera"]]
current = true

[node name="Aim_Cam" type="Camera3D" parent="cam_dial"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.343258, 0.920355, 1.06036)
fov = 60.0

[node name="magnet_ray" type="RayCast3D" parent="."]
debug_shape_custom_color = Color(0.501961, 0, 0.847059, 1)
debug_shape_thickness = 5

[node name="norm_vec" type="Node3D" parent="."]

[node name="MeshInstance3D" type="MeshInstance3D" parent="norm_vec"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1.02629)
material_override = SubResource("StandardMaterial3D_erjs0")
cast_shadow = 0
mesh = SubResource("BoxMesh_ef6tq")
skeleton = NodePath("../..")

[node name="MeshInstance3D" type="MeshInstance3D" parent="norm_vec/MeshInstance3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.00445)
material_override = SubResource("StandardMaterial3D_rcktv")
cast_shadow = 0
mesh = SubResource("BoxMesh_s6cnm")

[node name="mag" type="MeshInstance3D" parent="norm_vec"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, -1.66275)
material_override = SubResource("StandardMaterial3D_ao13a")
cast_shadow = 0
mesh = SubResource("PrismMesh_ma6o0")

[connection signal="animation_finished" from="human_animtree" to="human_animtree" method="_on_animation_finished"]
[connection signal="animation_started" from="human_animtree" to="human_animtree" method="_on_animation_started"]
[connection signal="body_entered" from="swivel_ring/hitbox_small" to="." method="_on_hitbox_detection" binds= [false, true]]
[connection signal="body_exited" from="swivel_ring/hitbox_small" to="." method="_on_hitbox_detection" binds= [false, false]]
[connection signal="body_entered" from="swivel_ring/hitbox_big" to="." method="_on_hitbox_detection" binds= [true, true]]
[connection signal="body_exited" from="swivel_ring/hitbox_big" to="." method="_on_hitbox_detection" binds= [true, false]]
[connection signal="animation_finished" from="human_node/human_model/AnimationPlayer" to="human_animtree" method="_on_animation_player_animation_finished"]

[editable path="human_node/human_model"]
[editable path="wolf_node/wolf_model"]
